# =============================================================================
# Grammarly Browser Use MCP Server - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values for your environment.
# IMPORTANT: Add .env to .gitignore â€” it contains secrets and must not be committed.
# All variables marked (required) must be set before the server will start.
# =============================================================================

# -----------------------------------------------------------------------------
# Browser Provider Selection (optional)
# -----------------------------------------------------------------------------
# Choose your browser automation provider:
#   - "stagehand" (default): Uses Stagehand + Browserbase for deterministic,
#     AI-powered browser automation with better reliability and self-healing.
#   - "browser-use": Uses Browser Use Cloud (legacy, for backward compatibility).
#
# The provider you select determines which configuration section below is required.
BROWSER_PROVIDER=stagehand

# =============================================================================
# STAGEHAND + BROWSERBASE CONFIGURATION (required when BROWSER_PROVIDER=stagehand)
# =============================================================================
# Get your API key and project ID from https://www.browserbase.com/
# Browserbase provides cloud browser infrastructure with stealth mode,
# CAPTCHA solving, and persistent login contexts.

# Browserbase API key for authentication
BROWSERBASE_API_KEY=bb_REPLACE_WITH_YOUR_API_KEY

# Browserbase project ID (found in your Browserbase dashboard)
BROWSERBASE_PROJECT_ID=REPLACE_WITH_YOUR_PROJECT_ID

# -----------------------------------------------------------------------------
# Stagehand Session Persistence (optional - recommended for faster execution)
# -----------------------------------------------------------------------------
# Reuse an existing session ID to skip browser initialization (saves ~30s).
# Get this from a previous session or leave empty for new sessions.
# BROWSERBASE_SESSION_ID=

# Persistent context ID for login state (cookies, localStorage).
# Create once via Browserbase API, then reuse to avoid re-logging into Grammarly.
# This is the key to avoiding login overhead on every request.
# BROWSERBASE_CONTEXT_ID=

# -----------------------------------------------------------------------------
# Stagehand LLM Configuration (optional)
# -----------------------------------------------------------------------------
# Model for Stagehand's AI operations (act, extract, observe).
# Default: gpt-4o (recommended for best performance/cost balance)
# Alternatives: gpt-4o-mini, claude-sonnet-4-20250514
STAGEHAND_MODEL=gpt-4o

# Optional cache directory for Stagehand action caching.
# Enables 2-3x faster repeated actions by caching LLM responses.
# STAGEHAND_CACHE_DIR=./cache

# =============================================================================
# BROWSER USE CLOUD CONFIGURATION (required when BROWSER_PROVIDER=browser-use)
# =============================================================================
# Get your API key from https://cloud.browser-use.com
# This key authenticates all Browser Use Cloud API requests.
BROWSER_USE_API_KEY=bu_your_api_key_here

# Browser Use profile ID containing your logged-in Grammarly session.
# Create a profile by syncing your browser session: npx browser-use-profile sync
# The profile stores Grammarly cookies/auth so the agent can access AI Detector
# and Plagiarism Checker features without manual login.
BROWSER_USE_PROFILE_ID=profile_your_profile_id_here

# =============================================================================
# CLAUDE AUTHENTICATION (optional - choose ONE method)
# =============================================================================
# Used for text rewriting and analysis (the LLM that rewrites your content).

# Option 1 (RECOMMENDED): Use Claude CLI authentication (Pro/Max subscription)
#   Run 'claude login' once to authenticate, then leave CLAUDE_API_KEY unset.
#   This uses your Claude Pro/Max subscription - no per-use billing.
#   Also works with ai-sdk-provider-claude-code for Stagehand's LLM operations.
#
# Option 2: Use API key authentication (pay-per-use billing)
#   Set CLAUDE_API_KEY below to use traditional API key billing.
#
# If CLAUDE_API_KEY is set, it takes precedence over CLI authentication.
# CLAUDE_API_KEY=sk-ant-...

# -----------------------------------------------------------------------------
# Logging Configuration (optional)
# -----------------------------------------------------------------------------
# Log level for server output (written to stderr, not stdout).
# MCP protocol messages use stdout; logs must go to stderr.
# Options: debug | info | warn | error
# Default: info
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Timeout Configuration (optional)
# -----------------------------------------------------------------------------
# Claude API request timeout in milliseconds (default: 120000 = 2 minutes)
# CLAUDE_REQUEST_TIMEOUT_MS=120000

# Browser connection timeout in milliseconds (default: 30000 = 30 seconds)
# CONNECT_TIMEOUT_MS=30000

# -----------------------------------------------------------------------------
# Notes
# -----------------------------------------------------------------------------
# - The server exposes one MCP tool: grammarly_optimize_text
# - Grammarly Premium/Business is required for AI Detector and Plagiarism Checker
# - Text is processed through browser automation, Grammarly UI, and Claude API
# - All logs are written to stderr (stdout is reserved for MCP JSON-RPC)
# - Stagehand provides deterministic automation with observe()->act()->extract()
# - Session/context reuse can reduce init time from 30s to <5s
